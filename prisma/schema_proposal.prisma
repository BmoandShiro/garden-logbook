// This is a schema proposal for enhanced logging capabilities

enum LogType {
  WATERING/FEEDING
  ENVIRONMENTAL
  PRUNING
  TRAINING
  DEFOLIATION
  FLUSHING
  HARVEST
  PEST_DISEASE
  TRANSPLANT
  GERMINATION
  CLONING
  INSPECTION
  TREATMENT
  STRESS
  GENERAL
  CUSTOM
}

enum Stage {
  SEEDLING
  VEGETATIVE
  FLOWERING
  MOTHER
  CLONE
  DRYING
  CURING
}

enum NutrientLine {
  JACKS_321
  CUSTOM
}

enum Jacks321Product {
  PART_A_5_12_26
  PART_B_15_0_0_CALCIUM_NITRATE
  PART_C_EPSOM_SALT
  BLOSSOMBOOST_10_30_20
  FINISH_7_15_30
}

enum WaterSource {
  TAP
  RO
  WELL
  FILTERED
  COLLECTED
  OTHER
}

enum PestCategory {
  INSECT
  FUNGI
  BACTERIA
  VIRUS
  OTHER
}

enum PestType {
  SPIDER_MITES
  THRIPS
  APHIDS
  FUNGUS_GNATS
  WHITEFLIES
  ROOT_APHIDS
  ASIAN_LADY_BEETLES
  BOX_ELDERS
  STINK_BUGS
  OTHER
}

enum DiseaseType {
  POWDERY_MILDEW
  BOTRYTIS
  ROOT_ROT
  LEAF_SEPTORIA
  FUSARIUM_WILT
  OTHER
}

enum TreatmentMethod {
  FOLIAR_SPRAY
  SOIL_DRENCH
  BENEFICIAL_INSECTS
  ENVIRONMENTAL_ADJUSTMENT
  MANUAL_REMOVAL
  OTHER
}

enum TrainingMethod {
  TOP
  FIM
  LST
  SCROG
  SUPER_CROP
  LOLLIPOP
  TRELLIS
  OTHER
}

enum VolumeUnit {
  MILLILITERS
  LITERS
  GALLONS
  FLUID_OUNCES
}

enum TemperatureUnit {
  CELSIUS
  FAHRENHEIT
}

enum DistanceUnit {
  CENTIMETERS
  INCHES
  FEET
  METERS
  YARDS
}

enum WeightUnit {
  GRAMS
  OUNCES
  POUNDS
  KILOGRAMS
}

enum LightIntensityUnit {
  UMOL_PER_M2_S
  LUX
  FOOTCANDLE
}

enum SuspectedStressCause {
  HEAT
  LIGHT_BURN
  OVERWATERING
  UNDERWATERING
  PH_IMBALANCE
  TOXICITY_ABUNDANCE
  DEFICIENCY
  PHYSICAL_DAMAGE
  PEST
  FUNGUS
  BACTERIA
  DISEASE
  OTHER
}

model Log {
  id                  String              @id @default(cuid())
  date                DateTime            @default(now())
  type                LogType
  stage               Stage
  logTitle            String?
  stressCause         SuspectedStressCause?

  // Notes and media
  notes               String?             @db.Text
  imageUrls           String[]
  logTypeImages       Json?               // {"WATERING": [...], "TRAINING": [...]} for per-type attachments

  // Environmental Measurements
  temperature         Float?
  temperatureUnit     TemperatureUnit?    @default(CELSIUS)
  humidity            Float?
  co2                 Float?
  vpd                 Float?
  par                 Float?
  parUnit             LightIntensityUnit? @default(UMOL_PER_M2_S)
  ppfd                Float?
  lightIntensity      Float?
  lightIntensityUnit  LightIntensityUnit? @default(UMOL_PER_M2_S)
  lightHeight         Float?
  lightHeightUnit     DistanceUnit?       @default(CENTIMETERS)
  airflow             Boolean?

  // Water & Feeding
  waterSource         WaterSource?
  waterAmount         Float?
  waterUnit           VolumeUnit?         @default(MILLILITERS)
  waterTemperature    Float?
  waterTemperatureUnit TemperatureUnit?   @default(CELSIUS)
  waterPh             Float?
  runoffPh            Float?
  waterEc             Float?
  runoffEc            Float?
  nutrientLine        NutrientLine?

  // Jack's 321 Specific
  jacks321Used        Jacks321Product[]
  partAAmount         Float?
  partBAmount         Float?
  partCAmount         Float?
  boosterAmount       Float?
  finishAmount        Float?

  // Custom Nutrients
  customNutrients     Json?

  // Plant Measurements
  height              Float?
  heightUnit          DistanceUnit?       @default(CENTIMETERS)
  width               Float?
  widthUnit           DistanceUnit?       @default(CENTIMETERS)
  nodeCount           Int?
  branchCount         Int?
  estimatedYield      Float?
  estimatedYieldUnit  WeightUnit?         @default(GRAMS)

  // Health & Issues
  healthRating        Int?
  pestTypes           PestType[]
  pestCategories      PestCategory[]      // Matches types to subcategory
  diseaseTypes        DiseaseType[]
  deficiencies        String[]
  leafColor           String?
  pestSeverity        Int?
  diseaseSeverity     Int?

  // Treatment Related
  treatmentMethods    TreatmentMethod[]
  treatmentProducts   String[]
  treatmentDosage     Float?
  treatmentDosageUnit String?

  // Training Related
  trainingMethods     TrainingMethod[]
  trimAmount          Float?
  trimAmountUnit      WeightUnit?         @default(GRAMS)

  // Harvest Related
  wetWeight           Float?
  wetWeightUnit       WeightUnit?         @default(GRAMS)
  dryWeight           Float?
  dryWeightUnit       WeightUnit?         @default(GRAMS)
  trimWeight          Float?
  trimWeightUnit      WeightUnit?         @default(GRAMS)

  // Drying & Curing
  dryingTemp          Float?
  dryingHumidity      Float?
  dryingDays          Int?
  curingDays          Int?

  // Soil/Medium Related
  mediumMoisture      Float?
  mediumTemp          Float?
  mediumPh            Float?

  // Relationships
  userId              String
  user                User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  gardenId            String?
  garden              Garden?             @relation(fields: [gardenId], references: [id])
  roomId              String?
  room                Room?               @relation(fields: [roomId], references: [id])
  zoneId              String?
  zone                Zone?               @relation(fields: [zoneId], references: [id])
  plantId             String?
  plant               Plant?              @relation(fields: [plantId], references: [id], onDelete: Cascade)
  plants              Plant[]             @relation("LogPlants")

  // Metadata
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt

  // Flexible field for extra metadata
  customData          Json?
}

model Plant {
  id          String     @id @default(cuid())
  name        String
  strainId    String?
  stage       Stage      @default(VEGETATIVE)
  location    String?
  startDate   DateTime   @default(now())
  harvestDate DateTime?
  notes       String?
  imageUrl    String?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  userId      String
  roomId      String?
  gardenId    String?
  type        PlantType  @default(REGULAR)
  zoneId      String?
  logs        Log[]      @relation("LogPlants")
  garden      Garden?    @relation(fields: [gardenId], references: [id], onDelete: Cascade)
  room        Room?      @relation(fields: [roomId], references: [id])
  strain      Strain?    @relation(fields: [strainId], references: [id])
  user        User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  zone        Zone?      @relation(fields: [zoneId], references: [id], onDelete: Cascade)
  logEntries  LogEntry[] @relation("LogEntryToPlant")
  tags        Tag[]      @relation("PlantToTag")
}
